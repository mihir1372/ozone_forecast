{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "91f055c8",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "575a8d77",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>Source</th>\n",
       "      <th>Site ID</th>\n",
       "      <th>POC</th>\n",
       "      <th>Daily Max 8-hour Ozone Concentration</th>\n",
       "      <th>Units</th>\n",
       "      <th>Daily AQI Value</th>\n",
       "      <th>Local Site Name</th>\n",
       "      <th>Daily Obs Count</th>\n",
       "      <th>Percent Complete</th>\n",
       "      <th>...</th>\n",
       "      <th>AQS Parameter Description</th>\n",
       "      <th>Method Code</th>\n",
       "      <th>CBSA Code</th>\n",
       "      <th>CBSA Name</th>\n",
       "      <th>State FIPS Code</th>\n",
       "      <th>State</th>\n",
       "      <th>County FIPS Code</th>\n",
       "      <th>County</th>\n",
       "      <th>Site Latitude</th>\n",
       "      <th>Site Longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>3/1/2018</td>\n",
       "      <td>AQS</td>\n",
       "      <td>371010002</td>\n",
       "      <td>1</td>\n",
       "      <td>0.037</td>\n",
       "      <td>ppm</td>\n",
       "      <td>34</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>17</td>\n",
       "      <td>100</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>47</td>\n",
       "      <td>39580</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3/2/2018</td>\n",
       "      <td>AQS</td>\n",
       "      <td>371010002</td>\n",
       "      <td>1</td>\n",
       "      <td>0.046</td>\n",
       "      <td>ppm</td>\n",
       "      <td>43</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>17</td>\n",
       "      <td>100</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>47</td>\n",
       "      <td>39580</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3/3/2018</td>\n",
       "      <td>AQS</td>\n",
       "      <td>371010002</td>\n",
       "      <td>1</td>\n",
       "      <td>0.047</td>\n",
       "      <td>ppm</td>\n",
       "      <td>44</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>17</td>\n",
       "      <td>100</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>47</td>\n",
       "      <td>39580</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3/4/2018</td>\n",
       "      <td>AQS</td>\n",
       "      <td>371010002</td>\n",
       "      <td>1</td>\n",
       "      <td>0.045</td>\n",
       "      <td>ppm</td>\n",
       "      <td>42</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>17</td>\n",
       "      <td>100</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>47</td>\n",
       "      <td>39580</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3/5/2018</td>\n",
       "      <td>AQS</td>\n",
       "      <td>371010002</td>\n",
       "      <td>1</td>\n",
       "      <td>0.046</td>\n",
       "      <td>ppm</td>\n",
       "      <td>43</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>17</td>\n",
       "      <td>100</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>47</td>\n",
       "      <td>39580</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1665</th>\n",
       "      <td>10/13/2024</td>\n",
       "      <td>AirNow</td>\n",
       "      <td>371010002</td>\n",
       "      <td>1</td>\n",
       "      <td>0.050</td>\n",
       "      <td>ppm</td>\n",
       "      <td>46</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>24</td>\n",
       "      <td>100</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>19</td>\n",
       "      <td>39580</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1666</th>\n",
       "      <td>10/14/2024</td>\n",
       "      <td>AirNow</td>\n",
       "      <td>371010002</td>\n",
       "      <td>1</td>\n",
       "      <td>0.050</td>\n",
       "      <td>ppm</td>\n",
       "      <td>46</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>24</td>\n",
       "      <td>100</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>19</td>\n",
       "      <td>39580</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1667</th>\n",
       "      <td>10/15/2024</td>\n",
       "      <td>AirNow</td>\n",
       "      <td>371010002</td>\n",
       "      <td>1</td>\n",
       "      <td>0.036</td>\n",
       "      <td>ppm</td>\n",
       "      <td>33</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>24</td>\n",
       "      <td>100</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>19</td>\n",
       "      <td>39580</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1668</th>\n",
       "      <td>10/16/2024</td>\n",
       "      <td>AirNow</td>\n",
       "      <td>371010002</td>\n",
       "      <td>1</td>\n",
       "      <td>0.031</td>\n",
       "      <td>ppm</td>\n",
       "      <td>29</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>24</td>\n",
       "      <td>100</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>19</td>\n",
       "      <td>39580</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1669</th>\n",
       "      <td>10/17/2024</td>\n",
       "      <td>AirNow</td>\n",
       "      <td>371010002</td>\n",
       "      <td>1</td>\n",
       "      <td>0.035</td>\n",
       "      <td>ppm</td>\n",
       "      <td>32</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>22</td>\n",
       "      <td>92</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>19</td>\n",
       "      <td>39580</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1670 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Date  Source    Site ID  POC  \\\n",
       "0       3/1/2018     AQS  371010002    1   \n",
       "1       3/2/2018     AQS  371010002    1   \n",
       "2       3/3/2018     AQS  371010002    1   \n",
       "3       3/4/2018     AQS  371010002    1   \n",
       "4       3/5/2018     AQS  371010002    1   \n",
       "...          ...     ...        ...  ...   \n",
       "1665  10/13/2024  AirNow  371010002    1   \n",
       "1666  10/14/2024  AirNow  371010002    1   \n",
       "1667  10/15/2024  AirNow  371010002    1   \n",
       "1668  10/16/2024  AirNow  371010002    1   \n",
       "1669  10/17/2024  AirNow  371010002    1   \n",
       "\n",
       "      Daily Max 8-hour Ozone Concentration Units  Daily AQI Value  \\\n",
       "0                                    0.037   ppm               34   \n",
       "1                                    0.046   ppm               43   \n",
       "2                                    0.047   ppm               44   \n",
       "3                                    0.045   ppm               42   \n",
       "4                                    0.046   ppm               43   \n",
       "...                                    ...   ...              ...   \n",
       "1665                                 0.050   ppm               46   \n",
       "1666                                 0.050   ppm               46   \n",
       "1667                                 0.036   ppm               33   \n",
       "1668                                 0.031   ppm               29   \n",
       "1669                                 0.035   ppm               32   \n",
       "\n",
       "        Local Site Name  Daily Obs Count  Percent Complete  ...  \\\n",
       "0     West Johnston Co.               17               100  ...   \n",
       "1     West Johnston Co.               17               100  ...   \n",
       "2     West Johnston Co.               17               100  ...   \n",
       "3     West Johnston Co.               17               100  ...   \n",
       "4     West Johnston Co.               17               100  ...   \n",
       "...                 ...              ...               ...  ...   \n",
       "1665  West Johnston Co.               24               100  ...   \n",
       "1666  West Johnston Co.               24               100  ...   \n",
       "1667  West Johnston Co.               24               100  ...   \n",
       "1668  West Johnston Co.               24               100  ...   \n",
       "1669  West Johnston Co.               22                92  ...   \n",
       "\n",
       "      AQS Parameter Description Method Code  CBSA Code    CBSA Name  \\\n",
       "0                         Ozone          47      39580  Raleigh, NC   \n",
       "1                         Ozone          47      39580  Raleigh, NC   \n",
       "2                         Ozone          47      39580  Raleigh, NC   \n",
       "3                         Ozone          47      39580  Raleigh, NC   \n",
       "4                         Ozone          47      39580  Raleigh, NC   \n",
       "...                         ...         ...        ...          ...   \n",
       "1665                      Ozone          19      39580  Raleigh, NC   \n",
       "1666                      Ozone          19      39580  Raleigh, NC   \n",
       "1667                      Ozone          19      39580  Raleigh, NC   \n",
       "1668                      Ozone          19      39580  Raleigh, NC   \n",
       "1669                      Ozone          19      39580  Raleigh, NC   \n",
       "\n",
       "     State FIPS Code           State County FIPS Code    County Site Latitude  \\\n",
       "0                 37  North Carolina              101  Johnston      35.59095   \n",
       "1                 37  North Carolina              101  Johnston      35.59095   \n",
       "2                 37  North Carolina              101  Johnston      35.59095   \n",
       "3                 37  North Carolina              101  Johnston      35.59095   \n",
       "4                 37  North Carolina              101  Johnston      35.59095   \n",
       "...              ...             ...              ...       ...           ...   \n",
       "1665              37  North Carolina              101  Johnston      35.59095   \n",
       "1666              37  North Carolina              101  Johnston      35.59095   \n",
       "1667              37  North Carolina              101  Johnston      35.59095   \n",
       "1668              37  North Carolina              101  Johnston      35.59095   \n",
       "1669              37  North Carolina              101  Johnston      35.59095   \n",
       "\n",
       "      Site Longitude  \n",
       "0           -78.4622  \n",
       "1           -78.4622  \n",
       "2           -78.4622  \n",
       "3           -78.4622  \n",
       "4           -78.4622  \n",
       "...              ...  \n",
       "1665        -78.4622  \n",
       "1666        -78.4622  \n",
       "1667        -78.4622  \n",
       "1668        -78.4622  \n",
       "1669        -78.4622  \n",
       "\n",
       "[1670 rows x 21 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv(\"Combined_Ozone.csv\")\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "9b942146",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data range: 2018-03-01 00:00:00 to 2024-10-17 00:00:00\n"
     ]
    }
   ],
   "source": [
    "# Ensure 'date' is a datetime object\n",
    "df['Date'] = pd.to_datetime(df['Date'])\n",
    "\n",
    "# Check for the range of dates\n",
    "print(f\"Data range: {df['Date'].min()} to {df['Date'].max()}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "e3c71035",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create a full date range from min to max\n",
    "full_date_range = pd.date_range(start=df['Date'].min(), end=df['Date'].max())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "db330be2",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Set 'date' as the index\n",
    "df = df.set_index('Date')\n",
    "\n",
    "# Reindex to include all dates\n",
    "df_full = df.reindex(full_date_range)\n",
    "\n",
    "# Reset index and rename columns\n",
    "df_full = df_full.reset_index().rename(columns={'index': 'Date'})\n",
    "\n",
    "# Optional: Fill missing values (e.g., NaN or specific value)\n",
    "df_full.fillna(0, inplace=True)  # Replace 0 with your preferred filler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "df54116f",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Save to a new CSV or use it further\n",
    "df1=df_full.to_csv('updated_Ozone.csv', index=False)\n",
    "df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "e8cdf35b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>Source</th>\n",
       "      <th>Site ID</th>\n",
       "      <th>POC</th>\n",
       "      <th>Daily Max 8-hour Ozone Concentration</th>\n",
       "      <th>Units</th>\n",
       "      <th>Daily AQI Value</th>\n",
       "      <th>Local Site Name</th>\n",
       "      <th>Daily Obs Count</th>\n",
       "      <th>Percent Complete</th>\n",
       "      <th>...</th>\n",
       "      <th>AQS Parameter Description</th>\n",
       "      <th>Method Code</th>\n",
       "      <th>CBSA Code</th>\n",
       "      <th>CBSA Name</th>\n",
       "      <th>State FIPS Code</th>\n",
       "      <th>State</th>\n",
       "      <th>County FIPS Code</th>\n",
       "      <th>County</th>\n",
       "      <th>Site Latitude</th>\n",
       "      <th>Site Longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-03-01</td>\n",
       "      <td>AQS</td>\n",
       "      <td>371010002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.037</td>\n",
       "      <td>ppm</td>\n",
       "      <td>34.0</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>17.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>47.0</td>\n",
       "      <td>39580.0</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37.0</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101.0</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-03-02</td>\n",
       "      <td>AQS</td>\n",
       "      <td>371010002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.046</td>\n",
       "      <td>ppm</td>\n",
       "      <td>43.0</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>17.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>47.0</td>\n",
       "      <td>39580.0</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37.0</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101.0</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-03-03</td>\n",
       "      <td>AQS</td>\n",
       "      <td>371010002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.047</td>\n",
       "      <td>ppm</td>\n",
       "      <td>44.0</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>17.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>47.0</td>\n",
       "      <td>39580.0</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37.0</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101.0</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-03-04</td>\n",
       "      <td>AQS</td>\n",
       "      <td>371010002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.045</td>\n",
       "      <td>ppm</td>\n",
       "      <td>42.0</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>17.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>47.0</td>\n",
       "      <td>39580.0</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37.0</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101.0</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-03-05</td>\n",
       "      <td>AQS</td>\n",
       "      <td>371010002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.046</td>\n",
       "      <td>ppm</td>\n",
       "      <td>43.0</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>17.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>47.0</td>\n",
       "      <td>39580.0</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37.0</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101.0</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2418</th>\n",
       "      <td>2024-10-13</td>\n",
       "      <td>AirNow</td>\n",
       "      <td>371010002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.050</td>\n",
       "      <td>ppm</td>\n",
       "      <td>46.0</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>24.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>19.0</td>\n",
       "      <td>39580.0</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37.0</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101.0</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2419</th>\n",
       "      <td>2024-10-14</td>\n",
       "      <td>AirNow</td>\n",
       "      <td>371010002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.050</td>\n",
       "      <td>ppm</td>\n",
       "      <td>46.0</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>24.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>19.0</td>\n",
       "      <td>39580.0</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37.0</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101.0</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2420</th>\n",
       "      <td>2024-10-15</td>\n",
       "      <td>AirNow</td>\n",
       "      <td>371010002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.036</td>\n",
       "      <td>ppm</td>\n",
       "      <td>33.0</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>24.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>19.0</td>\n",
       "      <td>39580.0</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37.0</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101.0</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2421</th>\n",
       "      <td>2024-10-16</td>\n",
       "      <td>AirNow</td>\n",
       "      <td>371010002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.031</td>\n",
       "      <td>ppm</td>\n",
       "      <td>29.0</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>24.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>19.0</td>\n",
       "      <td>39580.0</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37.0</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101.0</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2422</th>\n",
       "      <td>2024-10-17</td>\n",
       "      <td>AirNow</td>\n",
       "      <td>371010002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.035</td>\n",
       "      <td>ppm</td>\n",
       "      <td>32.0</td>\n",
       "      <td>West Johnston Co.</td>\n",
       "      <td>22.0</td>\n",
       "      <td>92.0</td>\n",
       "      <td>...</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>19.0</td>\n",
       "      <td>39580.0</td>\n",
       "      <td>Raleigh, NC</td>\n",
       "      <td>37.0</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>101.0</td>\n",
       "      <td>Johnston</td>\n",
       "      <td>35.59095</td>\n",
       "      <td>-78.4622</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2423 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Date  Source      Site ID  POC  \\\n",
       "0     2018-03-01     AQS  371010002.0  1.0   \n",
       "1     2018-03-02     AQS  371010002.0  1.0   \n",
       "2     2018-03-03     AQS  371010002.0  1.0   \n",
       "3     2018-03-04     AQS  371010002.0  1.0   \n",
       "4     2018-03-05     AQS  371010002.0  1.0   \n",
       "...          ...     ...          ...  ...   \n",
       "2418  2024-10-13  AirNow  371010002.0  1.0   \n",
       "2419  2024-10-14  AirNow  371010002.0  1.0   \n",
       "2420  2024-10-15  AirNow  371010002.0  1.0   \n",
       "2421  2024-10-16  AirNow  371010002.0  1.0   \n",
       "2422  2024-10-17  AirNow  371010002.0  1.0   \n",
       "\n",
       "      Daily Max 8-hour Ozone Concentration Units  Daily AQI Value  \\\n",
       "0                                    0.037   ppm             34.0   \n",
       "1                                    0.046   ppm             43.0   \n",
       "2                                    0.047   ppm             44.0   \n",
       "3                                    0.045   ppm             42.0   \n",
       "4                                    0.046   ppm             43.0   \n",
       "...                                    ...   ...              ...   \n",
       "2418                                 0.050   ppm             46.0   \n",
       "2419                                 0.050   ppm             46.0   \n",
       "2420                                 0.036   ppm             33.0   \n",
       "2421                                 0.031   ppm             29.0   \n",
       "2422                                 0.035   ppm             32.0   \n",
       "\n",
       "        Local Site Name  Daily Obs Count  Percent Complete  ...  \\\n",
       "0     West Johnston Co.             17.0             100.0  ...   \n",
       "1     West Johnston Co.             17.0             100.0  ...   \n",
       "2     West Johnston Co.             17.0             100.0  ...   \n",
       "3     West Johnston Co.             17.0             100.0  ...   \n",
       "4     West Johnston Co.             17.0             100.0  ...   \n",
       "...                 ...              ...               ...  ...   \n",
       "2418  West Johnston Co.             24.0             100.0  ...   \n",
       "2419  West Johnston Co.             24.0             100.0  ...   \n",
       "2420  West Johnston Co.             24.0             100.0  ...   \n",
       "2421  West Johnston Co.             24.0             100.0  ...   \n",
       "2422  West Johnston Co.             22.0              92.0  ...   \n",
       "\n",
       "      AQS Parameter Description Method Code  CBSA Code    CBSA Name  \\\n",
       "0                         Ozone        47.0    39580.0  Raleigh, NC   \n",
       "1                         Ozone        47.0    39580.0  Raleigh, NC   \n",
       "2                         Ozone        47.0    39580.0  Raleigh, NC   \n",
       "3                         Ozone        47.0    39580.0  Raleigh, NC   \n",
       "4                         Ozone        47.0    39580.0  Raleigh, NC   \n",
       "...                         ...         ...        ...          ...   \n",
       "2418                      Ozone        19.0    39580.0  Raleigh, NC   \n",
       "2419                      Ozone        19.0    39580.0  Raleigh, NC   \n",
       "2420                      Ozone        19.0    39580.0  Raleigh, NC   \n",
       "2421                      Ozone        19.0    39580.0  Raleigh, NC   \n",
       "2422                      Ozone        19.0    39580.0  Raleigh, NC   \n",
       "\n",
       "     State FIPS Code           State County FIPS Code    County Site Latitude  \\\n",
       "0               37.0  North Carolina            101.0  Johnston      35.59095   \n",
       "1               37.0  North Carolina            101.0  Johnston      35.59095   \n",
       "2               37.0  North Carolina            101.0  Johnston      35.59095   \n",
       "3               37.0  North Carolina            101.0  Johnston      35.59095   \n",
       "4               37.0  North Carolina            101.0  Johnston      35.59095   \n",
       "...              ...             ...              ...       ...           ...   \n",
       "2418            37.0  North Carolina            101.0  Johnston      35.59095   \n",
       "2419            37.0  North Carolina            101.0  Johnston      35.59095   \n",
       "2420            37.0  North Carolina            101.0  Johnston      35.59095   \n",
       "2421            37.0  North Carolina            101.0  Johnston      35.59095   \n",
       "2422            37.0  North Carolina            101.0  Johnston      35.59095   \n",
       "\n",
       "      Site Longitude  \n",
       "0           -78.4622  \n",
       "1           -78.4622  \n",
       "2           -78.4622  \n",
       "3           -78.4622  \n",
       "4           -78.4622  \n",
       "...              ...  \n",
       "2418        -78.4622  \n",
       "2419        -78.4622  \n",
       "2420        -78.4622  \n",
       "2421        -78.4622  \n",
       "2422        -78.4622  \n",
       "\n",
       "[2423 rows x 21 columns]"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df4=pd.read_csv('updated_Ozone.csv')\n",
    "df4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "4ae42275",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Date                                      0\n",
       "Source                                    0\n",
       "Site ID                                   0\n",
       "POC                                       0\n",
       "Daily Max 8-hour Ozone Concentration    753\n",
       "Units                                     0\n",
       "Daily AQI Value                           0\n",
       "Local Site Name                           0\n",
       "Daily Obs Count                           0\n",
       "Percent Complete                          0\n",
       "AQS Parameter Code                        0\n",
       "AQS Parameter Description                 0\n",
       "Method Code                               0\n",
       "CBSA Code                                 0\n",
       "CBSA Name                                 0\n",
       "State FIPS Code                           0\n",
       "State                                     0\n",
       "County FIPS Code                          0\n",
       "County                                    0\n",
       "Site Latitude                             0\n",
       "Site Longitude                            0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df4.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "7c751198",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(2423, 21)"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df4.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "f54091f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Step 1: Replace 0 values with the median of the column\n",
    "median_value = df4['Daily Max 8-hour Ozone Concentration'].replace(0, pd.NA).median()\n",
    "df4['Daily Max 8-hour Ozone Concentration'] = df4['Daily Max 8-hour Ozone Concentration'].replace(0, median_value)\n",
    "\n",
    "\n",
    "\n",
    "# # Save the updated dataset\n",
    "# output_path_median_interpolated = '/mnt/data/updated_Ozone_median_interpolated.csv'\n",
    "# df.to_csv(output_path_median_interpolated, index=False)\n",
    "\n",
    "# output_path_median_interpolated\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "a0a1ecf8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Step 2: Interpolate to smooth values further\n",
    "df4['Daily Max 8-hour Ozone Concentration'] = df4['Daily Max 8-hour Ozone Concentration'].interpolate(method='linear')\n",
    "\n",
    "df4['Daily Max 8-hour Ozone Concentration'] = df4['Daily Max 8-hour Ozone Concentration'].round(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "5b697cd4",
   "metadata": {},
   "outputs": [],
   "source": [
    "df7=df4.to_csv('updatedd_Ozonee.csv', index=False)\n",
    "df7"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f9f03d55",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
